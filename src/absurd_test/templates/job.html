{% extends "base.html" %}

{% block title %}Job {{ job.task_id[:8] if job else 'Not Found' }}{% endblock %}

{% block content %}
<p class="mb-4"><a href="/" class="text-blue-600 hover:underline">&larr; Back to all jobs</a></p>

{% if job %}
<div class="bg-white rounded-lg shadow p-6">
    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 mb-4">
        <span class="font-mono text-sm text-gray-500 break-all">{{ job.task_id }}</span>
        {% if job.status == 'pending' %}
        <span class="px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 whitespace-nowrap self-start sm:self-auto">pending</span>
        {% elif job.status == 'running' %}
        <span class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 whitespace-nowrap self-start sm:self-auto">running</span>
        {% elif job.status == 'completed' %}
        <span class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 whitespace-nowrap self-start sm:self-auto">completed</span>
        {% else %}
        <span class="px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800 whitespace-nowrap self-start sm:self-auto">{{ job.status }}</span>
        {% endif %}
    </div>

    <h3 class="text-lg font-semibold text-gray-700 mb-2">Prompt</h3>
    <p class="text-gray-700 mb-4">{{ job.prompt }}</p>

    {% if job.result %}
    <h3 class="text-lg font-semibold text-gray-700 mb-2">Result</h3>
    <div class="bg-gray-50 p-4 rounded text-gray-600 prose" data-markdown>{{ job.result }}</div>
    {% endif %}

    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 mt-6 pt-4 border-t border-gray-200">
        <p class="text-gray-400 text-sm">
            Created: {{ job.created_at }}
            {% if job.updated_at %} | Updated: {{ job.updated_at }}{% endif %}
        </p>
        <button hx-delete="/api/tasks/{{ job.task_id }}" hx-on::after-request="window.location='/'"
                class="text-sm text-red-500 hover:text-red-700 whitespace-nowrap self-start sm:self-auto">
            Delete this job
        </button>
    </div>
</div>
{% else %}
<div class="bg-white rounded-lg shadow p-6">
    <p class="text-gray-500">Job not found.</p>
</div>
{% endif %}
{% endblock %}
