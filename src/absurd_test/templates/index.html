{% extends "base.html" %}

{% block content %}
<div class="bg-white rounded-lg shadow p-6 mb-6">
    <form hx-post="/submit" hx-target="#job-list" hx-swap="innerHTML" hx-on::after-request="this.reset()" class="flex flex-col sm:flex-row items-stretch sm:items-center gap-3">
        <input type="text" name="prompt" placeholder="Enter a prompt..."
               class="flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
        <div class="flex gap-3">
            <input type="text" name="tag" placeholder="tag"
                   class="flex-1 sm:w-24 p-3 border border-gray-200 border-dashed rounded-lg text-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:text-gray-700 focus:border-solid">
            <button type="submit"
                    class="px-5 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer whitespace-nowrap">
                Submit
            </button>
        </div>
    </form>
</div>

<div class="bg-white rounded-lg shadow p-6 mb-6">
    <h2 class="text-xl font-semibold text-gray-700 mb-4">API</h2>

    <div class="space-y-4 text-sm">
        <div>
            <p class="font-medium text-gray-700 mb-1">Tasks</p>
            <div class="space-y-1 text-gray-600">
                <p><code class="bg-gray-100 px-1 rounded">POST /api/tasks</code> - Create task <span class="text-gray-400">{"prompt": "...", "tag": "..."}</span></p>
                <p><code class="bg-gray-100 px-1 rounded">GET /api/tasks/{id}</code> - Get task status</p>
                <p><code class="bg-gray-100 px-1 rounded">DELETE /api/tasks/{id}</code> - Delete task</p>
            </div>
        </div>

        <div>
            <p class="font-medium text-gray-700 mb-1">Webhooks</p>
            <div class="space-y-1 text-gray-600">
                <p><code class="bg-gray-100 px-1 rounded">POST /api/webhooks</code> - Register webhook <span class="text-gray-400">{"tag": "...", "url": "..."}</span></p>
                <p><code class="bg-gray-100 px-1 rounded">GET /api/webhooks</code> - List webhooks</p>
                <p><code class="bg-gray-100 px-1 rounded">DELETE /api/webhooks/{id}</code> - Delete webhook</p>
            </div>
        </div>
    </div>
</div>

<div class="bg-white rounded-lg shadow p-6">
    <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-semibold text-gray-700">Recent Jobs</h2>
    </div>
    <div id="job-list" hx-get="/partials/jobs" hx-trigger="every 2s">
        {% include "partials/jobs.html" %}
    </div>
</div>
{% endblock %}
